function barChart(){function a(a){a.each(function(){var a=d3.scaleBand().rangeRound([f.left,d-f.right],.1).domain(g.map(function(a){return a[h]})).paddingInner(.1),m=d3.scaleLinear().range([e-f.bottom,f.top]).domain([0,d3.max(g,function(a){return a[i]})]);j.domain(d3.extent(g,function(a){return a[i]}));var n=d3.select(this),o=n.append("svg").attr("class","bar-chart").attr("width",d).attr("height",e),p=(o.selectAll("rect.bar").data(g),!1),q=n.append("div").attr("class","tooltip").style("position","absolute").style("z-index","10").style("visibility","hidden").style("background-color","rgba(255,255,255,0.8)").text("a simple tooltip");o.append("g").attr("class","x axis").attr("transform","translate(0,"+(e-f.bottom)+")"),o.append("g").attr("class","y axis").attr("transform","translate("+f.left+",0)"),b&&o.append("text").attr("class","y label");var r=d3.axisBottom(a),s=d3.axisLeft(m).tickArguments([8]);draw=function(){var c=o.selectAll("rect.bar").data(g);c.exit().transition().duration(k).attr("y",function(a){return e-f.bottom}).attr("x",function(b){return a(b[h])}).attr("height",function(a){return 0}).attr("width",function(b){return a.rangeBand()}).remove(),c.enter().append("rect").attr("class","bar").merge(c).attr("y",function(a){return e-f.bottom}).attr("x",function(b){return a(b[h])}).attr("width",function(b){return a.bandwidth()}).on("mouseover",function(a){l&&(q.html(l(a)),p=!0,q.style("visibility","visible"))}).on("mousemove",function(){l&&q.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px")}).on("mouseout",function(){l&&(p=!1,q.style("visibility","hidden"))}).on("click",function(a){l&&(p?(q.style("visibility","hidden"),p=!1):(q.html(l(a)),q.style("visibility","visible"),q.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px"),p=!0))}).transition().duration(k).attr("x",function(b){return a(b[h])}).attr("y",function(a){return m(a[i])}).attr("height",function(a){return e-f.bottom-m(a[i])}).attr("width",function(b){return a.bandwidth()}).attr("fill",function(a){return j(a[i])}),o.select(".x.axis").transition().duration(k).attr("transform","translate(0,"+(e-f.bottom)+")").call(r).selectAll("text").style("text-anchor","end").attr("dx","-.5em").attr("dy",".15em").attr("transform","rotate(-35)"),o.select(".y.axis").transition().duration(k).attr("transform","translate("+f.left+",0)").call(s),b&&o.select(".y.label").attr("transform","rotate(-90)").attr("text-anchor","middle").attr("font-size","12px").attr("dx",-(e-f.bottom)/2).attr("dy","2em").text(b)},updateSize=function(){a.rangeRoundBands([f.left,d-f.right],.1),m.range([e-f.bottom,f.top]),o.transition().attr("width",d).attr("height",e),draw()},c=function(){a.domain(g.map(function(a){return a[h]})),m.domain(d3.extent(g,function(a){return a[i]})),j.domain(d3.extent(g,function(a){return a[i]})),draw()},draw()})}var b,c,d=600,e=400,f={top:10,bottom:200,left:80,right:10},g=[],h="x",i="y",j=d3.scaleQuantile().range(colorbrewer.Reds[7]).domain(d3.extent(g,function(a){return a[i]})),k=1e3,l=void 0;return a.width=function(b){return arguments.length?(d=b,"function"==typeof updateSize&&updateSize(),a):d},a.height=function(b){return arguments.length?(e=b,"function"==typeof updateSize&&updateSize(),a):e},a.data=function(b){return arguments.length?(g=b,"function"==typeof c&&c(),a):g},a.padding=function(b){return arguments.length?(f=b,"function"==typeof updateSize&&updateSize(),a):f},a.y_label=function(c){return arguments.length?(b=c,a):b},a.tooltip_function=function(b){return arguments.length?(l=b,a):l},a}