function barChart(){function a(a,b){a.each(function(a,c){for(var d,e=d3.select(this),f=a.split(/\s+/).reverse(),g=[],h=1,i=e.attr("y"),j=e.attr("x"),k=(parseFloat(e.attr("dy")||0),parseFloat(e.attr("dx")||0)),l=e.text(null).append("tspan").attr("x",j).attr("y",i);d=f.pop();)g.push(d),l.text(g.join(" ")),l.node().getComputedTextLength()>b-j-k&&(g.pop(),l.text(g.join(" ")),g=[d],l=e.append("tspan").attr("x",j).attr("dy",h+"em").attr("dx",k+"em").text(d))})}function b(b){b.each(function(){var b=d3.select(this),n=b.append("svg").attr("class","bar-chart").attr("width",e).attr("height",f);n.append("text").attr("class","x label"),n=n.append("g").attr("transform","translate("+g.left+","+g.right+")"),e=e-g.left-g.right,f=f-g.top-g.bottom;var o=d3.scaleLinear().rangeRound([0,e]).domain([0,d3.max(h,function(a){return a[i]})]),p=d3.scaleBand().rangeRound([0,f]).domain(h.map(function(a){return a[j]})).paddingInner(.2);k.domain(d3.extent(h,function(a){return a[i]}));var q=(n.selectAll("rect.bar").data(h),!1),r=b.append("div").attr("class","tooltip").style("position","absolute").style("z-index","10").style("visibility","hidden").style("background-color","rgba(255,255,255,0.8)").text("a simple tooltip"),s=d3.axisBottom(o),t=d3.axisLeft(p);draw=function(){var b=n.selectAll("rect.bar").data(h);b.exit().transition().duration(l).attr("y",function(a){return f-padding.bottom}).attr("x",function(a){return 0}).attr("height",function(a){return p.bandwidth()}).attr("width",function(a){return 0}).remove(),b.enter().append("rect").attr("class","bar").merge(b).attr("y",function(a){return p(a[j])}).attr("x",function(a){return 0}).attr("height",function(a){return p.bandwidth()}).attr("width",function(a){return 0}).on("mouseover",function(a){m&&(r.html(m(a)),q=!0,r.style("visibility","visible"))}).on("mousemove",function(){m&&r.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px")}).on("mouseout",function(){m&&(q=!1,r.style("visibility","hidden"))}).on("click",function(a){m&&(q?(r.style("visibility","hidden"),q=!1):(r.html(m(a)),r.style("visibility","visible"),r.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px"),q=!0))}).transition().duration(l).attr("x",function(a){return 0}).attr("y",function(a){return p(a[j])}).attr("height",function(a){return p.bandwidth()}).attr("width",function(a){return o(a[i])}).attr("fill",function(a){return k(a[i])}),n.append("g").attr("class","x axis").attr("transform","translate(0,"+f+")").call(s),n.append("g").attr("class","y axis").call(t).selectAll(".tick text").call(a,g.left-10),c&&d3.select(".x.label").attr("text-anchor","middle").attr("font-size","12px").attr("x",g.left+e/2).attr("y",f+50).text(c)},updateSize=function(){o.range([0,e]),p.range([f,0]),n.transition().attr("width",e).attr("height",f),draw()},d=function(){p.domain(h.map(function(a){return a[j]})),o.domain(d3.extent(h,function(a){return a[i]})),k.domain(d3.extent(h,function(a){return a[i]})),draw()},draw()})}var c,d,e=600,f=400,g={top:10,bottom:100,left:200,right:10},h=[],i="x",j="y",k=d3.scaleQuantile().range(colorbrewer.Reds[7]).domain(d3.extent(h,function(a){return a[i]})),l=1e3,m=void 0;return b.width=function(a){return arguments.length?(e=a,"function"==typeof updateSize&&updateSize(),b):e},b.height=function(a){return arguments.length?(f=a,"function"==typeof updateSize&&updateSize(),b):f},b.data=function(a){return arguments.length?(h=a,"function"==typeof d&&d(),b):h},b.padding=function(a){return arguments.length?(padding=a,"function"==typeof updateSize&&updateSize(),b):padding},b.x_label=function(a){return arguments.length?(c=a,b):c},b.tooltip_function=function(a){return arguments.length?(m=a,b):m},b}